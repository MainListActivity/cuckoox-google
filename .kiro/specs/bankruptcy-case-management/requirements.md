# 需求文档

## 介绍

破产案件全生命周期管理平台是一个为破产案件管理人提供的综合性案件管理和分析平台。该平台支持破产案件的完整流程管理，从立案到结案的全生命周期管理，包括案件管理、债权申报、债权审核、会议管理以及数据可视化分析等核心功能。

平台基于现有的技术栈构建，包括React 19 + TypeScript前端、SurrealDB实时数据库、MinIO文件存储以及QuillJS富文本编辑器，提供实时协作和数据同步能力。

## 需求

### 需求 1：用户认证与案件选择系统

**用户故事：** 作为系统用户，我希望能够通过GitHub OIDC或直接登录方式访问系统，并自动选择或手动选择要操作的案件，以便开始我的工作流程。

#### 验收标准

1. WHEN 用户访问系统 THEN 系统应提供GitHub OIDC登录和直接登录两种方式
2. WHEN 用户通过GitHub OIDC成功登录 THEN 系统应根据URL参数或用户历史记录自动选择案件
3. IF URL包含case参数且用户有权限 THEN 系统应直接进入指定案件并更新用户的案件选择记录
4. WHEN 用户参与多个案件且无历史选择记录 THEN 系统应引导用户进入案件选择页面
5. WHEN 用户选择案件后 THEN 系统应查询用户角色权限并动态渲染可访问菜单
6. WHEN URL包含admin=true参数 THEN 系统应提供SurrealDB直接登录选项

### 需求 2：案件全生命周期管理

**用户故事：** 作为案件管理人，我希望能够创建、管理和跟踪破产案件的完整生命周期，包括状态流转和关键时间节点管理，以确保案件按法律程序正确进行。

#### 验收标准

1. WHEN 管理人创建新案件 THEN 系统应记录案件基本信息并设置初始状态为"立案"
2. WHEN 案件状态需要变更 THEN 系统应根据当前状态提供合法的下一状态选项
3. WHEN 案件状态变更为"公告" THEN 系统应记录公告时间并创建案件机器人账号
4. WHEN 案件进入特定阶段 THEN 系统应根据时间规则发送提醒消息
5. WHEN 案件处于会议阶段 THEN 系统应提供会议纪要编辑功能
6. WHEN 案件状态为"裁定重整" THEN 系统应要求提交裁定重整公告和重整计划文档

### 需求 3：债权人信息管理

**用户故事：** 作为案件管理人，我希望能够录入、管理债权人信息并进行批量操作，以便高效处理大量债权人数据。

#### 验收标准

1. WHEN 管理人添加债权人 THEN 系统应支持录入组织和个人两种类型的债权人信息
2. WHEN 管理人需要批量导入债权人 THEN 系统应支持Excel/CSV文件上传并提供模板下载
3. WHEN 导入数据存在错误 THEN 系统应进行数据校验并提供详细的错误反馈
4. WHEN 管理人选择债权人 THEN 系统应支持生成快递单打印格式
5. WHEN 案件处于立案阶段 THEN 系统应自动导航至债权人管理菜单

### 需求 4：债权申报系统

**用户故事：** 作为债权人，我希望能够在线申报我的债权并上传相关证明材料，以便参与破产程序并维护我的合法权益。

#### 验收标准

1. WHEN 案件处于债权申报阶段 THEN 债权人应能访问债权申报模块
2. WHEN 债权人录入基本债权信息 THEN 系统应自动计算债权总额
3. WHEN 债权人编辑附件材料 THEN 系统应提供QuillJS富文本编辑器支持图片和文件上传
4. WHEN 债权人提交申报 THEN 债权状态应变更为"待审核"且债权人失去编辑权限
5. WHEN 管理人驳回债权申报 THEN 债权人应重新获得编辑权限
6. WHEN 债权人查看申报列表 THEN 系统应显示所有自己申报的债权及其审核状态

### 需求 5：债权审核管理

**用户故事：** 作为案件管理人，我希望能够审核债权人申报的债权，包括查看附件材料、添加批注和确定最终认定金额，以确保债权确认的准确性。

#### 验收标准

1. WHEN 案件进入债权申报阶段 THEN 系统应自动导航至债权审核菜单
2. WHEN 管理人查看债权列表 THEN 系统应显示债权人信息、主张债权和审核状态
3. WHEN 管理人审核单个债权 THEN 系统应提供左右分栏布局显示申报信息和附件材料
4. WHEN 管理人对附件材料添加批注 THEN 系统应支持段落级别的评论和高亮标注
5. WHEN 管理人提交审核结果 THEN 系统应记录认定债权金额、审核状态和审核意见
6. WHEN 管理人需要批量操作 THEN 系统应支持批量驳回功能

### 需求 6：实时数据大屏

**用户故事：** 作为案件管理人，我希望能够通过数据大屏实时监控债权申报和审核情况，以便及时了解案件进展和做出决策。

#### 验收标准

1. WHEN 用户访问数据大屏 THEN 系统应显示当前案件的实时统计数据
2. WHEN 有新的债权申报或审核操作 THEN 大屏数据应实时更新
3. WHEN 用户登录或退出 THEN 在线用户统计应实时变化
4. WHEN 查看债权统计 THEN 系统应按金额和笔数分别统计申报、已审和待审债权
5. WHEN 查看趋势分析 THEN 系统应提供债权申报的时间趋势图表
6. WHEN 查看构成分析 THEN 系统应提供不同债权性质的占比分析

### 需求 7：在线会议管理

**用户故事：** 作为案件管理人，我希望能够安排和管理债权人会议，并记录会议纪要，以满足破产程序中的会议要求。

#### 验收标准

1. WHEN 案件处于会议阶段 THEN 在线会议模块应对有权限用户可见
2. WHEN 管理人安排新会议 THEN 系统应支持录入会议基本信息和参会人员
3. WHEN 会议结束后 THEN 管理人应能编辑和保存会议纪要
4. WHEN 查看会议列表 THEN 系统应显示会议状态和相关操作选项
5. WHEN 会议信息变更 THEN 系统应支持编辑未开始的会议信息

### 需求 8：消息中心与通知系统

**用户故事：** 作为系统用户，我希望能够接收系统通知和与其他用户进行沟通，以便及时了解重要信息和协作处理案件事务。

#### 验收标准

1. WHEN 案件状态接近关键时间节点 THEN 案件机器人应发送提醒消息
2. WHEN 债权审核状态变更 THEN 相关用户应收到通知消息
3. WHEN 用户访问消息中心 THEN 系统应区分显示IM聊天和系统通知
4. WHEN 用户查看通知 THEN 系统应支持标记已读和按类型筛选
5. WHEN 用户需要沟通 THEN 系统应支持用户间的即时消息功能

### 需求 9：权限管理系统

**用户故事：** 作为系统管理员，我希望能够配置用户角色和权限，以确保不同用户只能访问其职责范围内的功能。

#### 验收标准

1. WHEN 管理员创建角色 THEN 系统应支持配置菜单访问权限和操作权限
2. WHEN 用户登录系统 THEN 系统应根据用户角色动态渲染可访问菜单
3. WHEN 用户执行操作 THEN 系统应验证用户是否具有相应权限
4. WHEN 案件状态变化 THEN 系统应根据状态和权限控制菜单可见性
5. WHEN 管理员分配角色 THEN 系统应支持用户与角色的关联管理

### 需求 10：系统配置管理

**用户故事：** 作为系统管理员，我希望能够配置系统的基础数据和参数，以适应不同的业务需求和流程变化。

#### 验收标准

1. WHEN 管理员配置审核状态 THEN 系统应支持自定义债权审核的状态选项
2. WHEN 管理员配置债权性质 THEN 系统应支持自定义债权申报的性质选项
3. WHEN 管理员配置通知规则 THEN 系统应支持自定义案件提醒的时间和内容
4. WHEN 配置变更后 THEN 系统应立即生效并影响相关功能模块
5. WHEN 查看配置列表 THEN 系统应提供增删改查的完整操作界面