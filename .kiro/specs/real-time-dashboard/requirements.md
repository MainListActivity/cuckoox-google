# 需求文档

## 介绍

实时数据大屏系统是破产案件全生命周期管理平台的核心可视化组件，旨在为案件管理人提供直观、实时的数据监控界面。该系统通过SurrealDB Live Query技术实现数据的实时同步，结合现代化的图表可视化技术，为用户提供债权申报和审核情况的全方位监控能力。

系统将集成现有的案件管理、债权申报、债权审核、用户管理等模块，通过实时数据流处理和智能化的数据分析，帮助管理人及时了解案件进展，做出准确的业务决策。

## 需求

### 需求 1：实时数据监控基础架构

**用户故事：** 作为案件管理人，我希望系统能够实时监控当前案件的各项数据变化，以便及时了解案件进展情况。

#### 验收标准

1. WHEN 用户访问数据大屏 THEN 系统应建立与SurrealDB的Live Query连接
2. WHEN 债权数据发生变化 THEN 大屏应在3秒内更新相关统计数据
3. WHEN 用户登录或退出 THEN 在线用户统计应实时更新
4. WHEN 网络连接中断 THEN 系统应显示连接状态并尝试自动重连
5. WHEN 数据加载失败 THEN 系统应显示友好的错误提示并提供重试选项
6. WHEN 大屏页面关闭 THEN 系统应正确清理所有Live Query订阅

### 需求 2：债权统计数据展示

**用户故事：** 作为案件管理人，我希望能够查看债权申报和审核的统计数据，包括金额和笔数的分类统计，以便掌握整体债权情况。

#### 验收标准

1. WHEN 查看债权金额统计 THEN 系统应显示申请总额、已审总额、待审总额
2. WHEN 查看债权笔数统计 THEN 系统应显示申请总笔数、已审总笔数、待审总笔数
3. WHEN 查看债权人统计 THEN 系统应显示已申报的债权人数量（去重）
4. WHEN 债权状态变更 THEN 相关统计数据应实时更新
5. WHEN 统计数据为零 THEN 系统应显示友好的空状态提示
6. WHEN 数据量较大 THEN 系统应使用合适的数字格式化显示（如千分位分隔符）

### 需求 3：用户活动监控

**用户故事：** 作为案件管理人，我希望能够监控当前案件相关用户的在线状态和活动情况，以便了解系统使用情况和协调工作安排。

#### 验收标准

1. WHEN 查看用户在线状态 THEN 系统应按角色分类显示在线用户数量
2. WHEN 用户登录系统 THEN 在线用户统计应立即增加
3. WHEN 用户退出系统 THEN 在线用户统计应立即减少
4. WHEN 用户提交债权申报 THEN 系统应记录并显示最近的申报活动
5. WHEN 管理人完成债权审核 THEN 系统应记录并显示最近的审核活动
6. WHEN 查看活动历史 THEN 系统应显示最近10条重要业务操作记录

### 需求 4：数据可视化图表

**用户故事：** 作为案件管理人，我希望通过各种图表形式查看数据趋势和分布情况，以便更直观地分析案件数据。

#### 验收标准

1. WHEN 查看债权申报趋势 THEN 系统应提供按日期统计的折线图或柱状图
2. WHEN 查看债权性质分布 THEN 系统应提供饼图或环形图显示不同性质债权占比
3. WHEN 查看审核状态分布 THEN 系统应提供条形图显示各审核状态的债权数量
4. WHEN 查看债权人地域分布 THEN 系统应提供地图或列表显示债权人分布情况
5. WHEN 图表数据更新 THEN 应有平滑的动画过渡效果
6. WHEN 点击图表元素 THEN 应提供详细数据的弹窗或跳转功能

### 需求 5：核心指标卡片

**用户故事：** 作为案件管理人，我希望能够快速查看关键业务指标，以便迅速了解案件的核心数据。

#### 验收标准

1. WHEN 查看核心指标 THEN 系统应显示申请总额、已审总额、待审总额等关键数字
2. WHEN 指标数据变化 THEN 卡片应显示变化趋势（上升、下降、持平）
3. WHEN 指标数值较大 THEN 系统应使用合适的单位显示（万元、亿元等）
4. WHEN 比较不同时期数据 THEN 系统应显示环比或同比变化百分比
5. WHEN 点击指标卡片 THEN 应跳转到相关的详细页面
6. WHEN 指标异常 THEN 系统应使用不同颜色或图标进行提醒

### 需求 6：实时动态信息流

**用户故事：** 作为案件管理人，我希望能够查看最近发生的重要业务操作，以便及时了解系统活动和处理紧急情况。

#### 验收标准

1. WHEN 有新的债权申报 THEN 动态信息流应显示申报人和债权金额
2. WHEN 完成债权审核 THEN 动态信息流应显示审核结果和审核人
3. WHEN 用户登录系统 THEN 动态信息流应显示登录用户和时间
4. WHEN 案件状态变更 THEN 动态信息流应显示状态变更信息
5. WHEN 信息流过多 THEN 系统应自动滚动显示最新的20条记录
6. WHEN 点击动态信息 THEN 应跳转到相关的详细页面或弹出详情

### 需求 7：响应式布局和主题适配

**用户故事：** 作为系统用户，我希望数据大屏能够在不同设备和主题下正常显示，以便在各种环境下使用系统。

#### 验收标准

1. WHEN 在PC端访问 THEN 大屏应采用多列布局充分利用屏幕空间
2. WHEN 在移动端访问 THEN 大屏应采用单列布局适配小屏幕
3. WHEN 切换深色主题 THEN 所有图表和组件应适配深色配色方案
4. WHEN 切换浅色主题 THEN 所有图表和组件应适配浅色配色方案
5. WHEN 屏幕尺寸变化 THEN 图表应自动调整大小保持最佳显示效果
6. WHEN 使用高分辨率屏幕 THEN 图表和文字应保持清晰度

### 需求 8：性能优化和缓存策略

**用户故事：** 作为系统用户，我希望数据大屏能够快速加载和流畅运行，即使在数据量较大的情况下也能保持良好的性能。

#### 验收标准

1. WHEN 首次加载大屏 THEN 页面应在3秒内完成初始渲染
2. WHEN 数据量超过1000条债权 THEN 系统应使用分页或虚拟滚动优化性能
3. WHEN 频繁更新数据 THEN 系统应使用防抖机制避免过度渲染
4. WHEN 网络较慢 THEN 系统应显示加载状态和进度提示
5. WHEN 长时间运行 THEN 系统应定期清理无用的数据和订阅
6. WHEN 内存使用过高 THEN 系统应自动释放不必要的资源

### 需求 9：数据导出和分享

**用户故事：** 作为案件管理人，我希望能够导出大屏数据或生成报告，以便在会议中展示或存档备查。

#### 验收标准

1. WHEN 需要导出数据 THEN 系统应支持Excel格式的统计数据导出
2. WHEN 需要分享图表 THEN 系统应支持图表的PNG或PDF格式导出
3. WHEN 生成报告 THEN 系统应包含当前时间和案件基本信息
4. WHEN 导出大量数据 THEN 系统应显示导出进度和完成提示
5. WHEN 导出失败 THEN 系统应显示错误原因和重试选项
6. WHEN 定期生成报告 THEN 系统应支持设置自动导出计划

### 需求 10：权限控制和安全性

**用户故事：** 作为系统管理员，我希望能够控制不同用户对数据大屏的访问权限，确保敏感数据的安全性。

#### 验收标准

1. WHEN 用户访问大屏 THEN 系统应验证用户是否有查看权限
2. WHEN 用户无权限 THEN 系统应显示权限不足提示并阻止访问
3. WHEN 不同角色用户访问 THEN 系统应根据权限显示不同的数据范围
4. WHEN 敏感数据展示 THEN 系统应根据用户权限进行数据脱敏
5. WHEN 用户权限变更 THEN 系统应实时更新用户的访问权限
6. WHEN 记录访问日志 THEN 系统应记录用户访问大屏的时间和操作